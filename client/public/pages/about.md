1. Introduction
Identifying the corresponding transcription factor binding sites (TFBSs) which are short and conserved DNA motifs, is crucial for studying transcription factor (TF) regulations. The footprints of Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq) can simultaneously reveal more kinds of TFBSs than traditional sequencing technologies (Bentsen et al., 2020). Furthermore, a graph neural network (GNN) can be considered as the extension of convolutional neural network, which learns the representation of target nodes via their neighbors (Feng et al., 2020). GNN has great potential in finding multiple motifs from ATAC-seq data. In this study, we develop a robust and effective tool, named MMGraph, for finding multiple motifs from ATAC-seq data.
2. Materials and methods
MMGraph is based on GNN and coexisting probability of k-mers, where the coexisting probability represents the degree of association between k-mers. It consists of three components (Fig. 1): (i) a heterogeneous graph; (ii) a three-layer GNN model to get embeddings of k-mers and sequences; and (iii) coexisting probability calculation for finding multiple motifs.
2.1 Constructing the heterogeneous graph
The sequence set S contains n sequences s(·), s(·)∈S. If s(i) contains TFBSs, we set label of s(i) as positive ‘1’, otherwise as negative ‘0’, i∈[1,…,n]. s(·) is trimmed into the same length fragments of k-mers as k(·) by the step of one base. We set lenk=length(k(·)), lenk≥5 is used in previous paper (Fletez-Brant et al., 2013). Ks(i) is a k-mer set that contains all unique k(·) existing in s(i)⁠. K is an m k-mer set that contains all unique Ks(⋅) in all Ks(i) of S⁠. Three edge types are defined (i.e. similarity edges, coexisting edges and inclusive edges) to build a heterogeneous graph where s(⋅) and k(⋅) are nodes. where Wsim represents the weight matrix of similarity edges,   p ,q∈[1,…,m]⁠. where Wco represents the weight matrix of coexisting edges, num(k(⋅)) represents the total number of Ks(⋅) that contain k(⋅)⁠; nums(k(p),k(q)) is the total number of Ks(⋅) that contain both k(p) and k(q)⁠. where Winclu represents the weight matrix of inclusive edges, tf(k(p),s(i)) is the number of k(p) existing in s(i)⁠, i∈[1,…,n]⁠.
1.Similarity edges. Similarity edges measure mismatch between k(⋅) nodes using the Hamming distance (Norouzi et al., 2012). The similarity edge weight between two nodes k(p) and k(q) is calculated by the formula (1):wsim(p,q)=wsim(q,p)=Hamming(k(p),k(q)),(1)
2. Coexisting edges. Coexisting edges measure the coexisting probability between k(⋅) nodes. The coexisting edge weight between two k-mers k(p) and k(q) is calculated by the formula (2):wco(p,q)=wco(q,p)=  −log(Q(k(p),k(q))P(k(p))P(k(q)))        if   nums(k(p),k(q))>0                                  P(k(p))=num(k(p))n,  Q(k(p),k(q))=nums(k(p),k(q))n,(2)
3. Inclusive edges. Inclusive edges measure the dependency degree between k(⋅) and s(⋅)⁠. The inclusive edge weight between k(⋅) and s(⋅) is calculated by transferring the concept of term frequency-inverse document frequency (TF-IDF) (Yun-Tao et al., 2005) to formula (3):winclu(p,i)=tf(k(p),s(i))×log(nnum(k(p)))      if  k(p)∈Ks(i),(3)
2.2 Building the GNN model
MMGraph decomposes the heterogeneous graph into three sub-graphs, i.e. similarity graph, coexisting graph and inclusive graph. Then, it uses the labels of s(⋅) as targets to train a three-layer of GNN model. The first layer learns the concatenated embedding of k(⋅) as Esc(k(⋅))∈Rds+dc⁠, where ds and dc are the embedding dimensions of Es(k(⋅))∈Rds and Ec(k(⋅))∈Rdc from similarity graph and coexisting graph respectively. The second layer learns the embedding of s(⋅) as Esq(s(⋅))∈Rdsq from inclusive graph, where dsq is the dimension of Esq(s(⋅))⁠. The third layer is a fully connected layer, which identifies whether a label of s(⋅) is ‘1’ that contains TFBSs or not by threshold 0.5 (Supplementary material).
2.3 Finding multiple motifs
After getting the embeddings of k(⋅) and s(⋅)⁠, we calculate mutual information (MI) of k(⋅) and s(⋅) by their corresponding embedding Esc(k(⋅)) and Esq(s(⋅))⁠. The mi(p,i) measures the information that k(p) and s(i) shared. In order to indicate MI for different s(⋅) with labels, we subdivide S into Slabel by sequences’ label of ‘1’ and ‘0’, as well as nlabel⁠, mlabel⁠, slabel(⋅)⁠, Kslabel(⋅) and Klabel for n⁠, m⁠, s(⋅)⁠, Ks(⋅) and K⁠. The whole procedure of motifs finding includes four steps.
1.obtain MIlabel matrix by calculating mi(p,i)⁠, where  k(p)∈Klabel⁠, s(i)∈slabel(⋅)⁠, i∈[1,…,nlabel]⁠, label=1/0⁠.
2.get the denoised dnMI1 matrix by dnmi1(p,i)=mi1(p,i)−mean(MI0)⁠, where the background noise mean(MI0)=∑m0q=1∑n0i=1mi0(q,i)/(m0×n0)⁠.
3.get the Kseed(i) set that contains all unique k(p) in s1(i)⁠, s.t. dnmi1(p,i)>0⁠, i∈[1,…,n1]⁠, then locate the interval of k(p) in s1(i) as itvk(p)=[startk(p),startk(p)+lenk−1]⁠, where k(p)∈Kseed(i)⁠, startk(p) is the starting position of k(p) in s1(i)⁠. If multiple k(p) exist in s1(i)⁠, there will be multiple itvk(p)⁠.
4.then get two k(⋅) centered on itvk(p) as kl(p)=[ck(p)−lenk+1,ck(p)] and kr(p)=[ck(p)+1,ck(p)+lenk]⁠, where ck(p)=startk(p)+⌈(lenk−1)/2⌉⁠, kl(p),kr(p)∈K⁠. If wco(kl(p),kr(p))<−log(0.5)⁠, which means that kl(p) and kr(p) have a strong relation, we merge kl(p) and kr(p) to a candidate TFBS as tfbs(p)=[ck(p)−lenk+1,ck(p)+lenk]⁠; otherwise, kl(p) and kr(p) will not be considered. For all k(⋅)∈Kseed(i)⁠, we can find multiple candidates tfbs(⋅) in s1(i)⁠. If multiple tfbs(⋅) overlapped, they may be merged to a longer TFBS in s1(i)⁠. Finally, we can find multiple tfbs(⋅) with different lengths.
3. Experiments and results
The experiment has been conducted on 88 ATAC-seq datasets. For each sequence set, sequences in this set were acquired by ATAC-seq footprints, which were all positive sequences with label ‘1’. We randomly shuffled all bases within a positive sequence to generate a negative sequence with label ‘0’ (Alipanahi et al., 2015). The negative sequence did not contain TFBSs, but with the same GC content as the positive sequence. The area of eight metrics radar (AEMR) was used to evaluate tools’ capability in identifying whether the sequence contains TFBSs (Zhang et al., 2022), and the P-value was used to measure the quality of tools’ found motifs. Our results show that MMGraph achieved the highest AEMR score of 2.31 while lenk=5⁠, and could find 207 higher-quality motifs compare to four comparison tools (Supplementary data).